#!/bin/bash -e

echo "â³ Attente de la base PostgreSQL..."
until pg_isready -h "$POSTGRES_HOST" -p "$POSTGRES_PORT" -U "$POSTGRES_USER"; do
  sleep 1
done

echo "âœ… PostgreSQL est prÃªt !"

bundle check || bundle install
echo "ğŸ“¦ PrÃ©paration DB..."
bundle exec rails db:prepare

echo "ğŸš€ Lancement de Rails..."
exec "$@"

